<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>115å¹´ç”³è«‹å…¥å­¸è½é»å»ºè­°ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; color: #0f172a; overflow-x: hidden; }
        .std-tag { padding: 1px 0; border-radius: 4px; font-size: 10px; font-weight: 900; text-align: center; display: block; width: 34px; }
        .tag-é ‚æ¨™ { background: #fee2e2; color: #991b1b; border: 1px solid #fecaca; }
        .tag-å‰æ¨™ { background: #ffedd5; color: #9a3412; border: 1px solid #fed7aa; }
        .tag-å‡æ¨™ { background: #dbeafe; color: #1e40af; border: 1px solid #bfdbfe; }
        .tag-ä¸æ¡è¨ˆ { background: #f8fafc; color: #cbd5e1; border: 1px solid #f1f5f9; }
        .score-input { border: 1.5px solid #e2e8f0; transition: all 0.2s; font-size: 16px; }
        .score-input:focus { border-color: #2563eb; background: #fff; outline: none; }
        .input-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; }
        @media (min-width: 1024px) { .input-grid { grid-template-columns: repeat(6, 1fr); gap: 10px; } }
        #search-section { display: none; }
        input[type=number]::-webkit-inner-spin-button { -webkit-appearance: none; }
    </style>
</head>
<body class="antialiased flex flex-col min-h-screen">

    <header class="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-md">
        <div class="max-w-6xl mx-auto p-3 sm:p-5">
            <div class="flex items-center justify-between mb-3">
                <div class="flex items-center gap-1.5">
                    <span class="text-xl">ğŸ“‹</span>
                    <h1 class="text-base sm:text-lg font-black text-slate-950 tracking-tighter">115 å¹´ç”³è«‹å…¥å­¸è½é»å»ºè­°</h1>
                </div>
                <div id="data-status" class="text-[8px] font-black text-slate-400 bg-slate-50 px-1.5 py-0.5 rounded border border-slate-100 uppercase">Connecting</div>
            </div>
            
            <div class="input-grid mb-3">
                <div>
                    <label class="text-[9px] font-black text-slate-400 block text-center mb-0.5">åœ‹æ–‡</label>
                    <input type="number" id="ch" oninput="updateLevels()" placeholder="åˆ†æ•¸" class="score-input w-full bg-slate-50 rounded-lg py-1.5 text-center font-black text-slate-950">
                    <div id="level-ch" class="text-[8px] text-center font-black h-3"></div>
                </div>
                <div>
                    <label class="text-[9px] font-black text-slate-400 block text-center mb-0.5">è‹±æ–‡</label>
                    <input type="number" id="en" oninput="updateLevels()" placeholder="åˆ†æ•¸" class="score-input w-full bg-slate-50 rounded-lg py-1.5 text-center font-black text-slate-950">
                    <div id="level-en" class="text-[8px] text-center font-black h-3"></div>
                </div>
                <div>
                    <label class="text-[9px] font-black text-blue-500 block text-center mb-0.5">æ•¸A</label>
                    <input type="number" id="ma" oninput="updateLevels()" placeholder="åˆ†æ•¸" class="score-input w-full bg-slate-50 rounded-lg py-1.5 text-center font-black text-slate-950">
                    <div id="level-ma" class="text-[8px] text-center font-black h-3"></div>
                </div>
                <div>
                    <label class="text-[9px] font-black text-emerald-500 block text-center mb-0.5">æ•¸B</label>
                    <input type="number" id="mb" oninput="updateLevels()" placeholder="åˆ†æ•¸" class="score-input w-full bg-slate-50 rounded-lg py-1.5 text-center font-black text-slate-950">
                    <div id="level-mb" class="text-[8px] text-center font-black h-3"></div>
                </div>
                <div>
                    <label class="text-[9px] font-black text-slate-400 block text-center mb-0.5">ç¤¾æœƒ</label>
                    <input type="number" id="so" oninput="updateLevels()" placeholder="åˆ†æ•¸" class="score-input w-full bg-slate-50 rounded-lg py-1.5 text-center font-black text-slate-950">
                    <div id="level-so" class="text-[8px] text-center font-black h-3"></div>
                </div>
                <div>
                    <label class="text-[9px] font-black text-slate-400 block text-center mb-0.5">è‡ªç„¶</label>
                    <input type="number" id="sc" oninput="updateLevels()" placeholder="åˆ†æ•¸" class="score-input w-full bg-slate-50 rounded-lg py-1.5 text-center font-black text-slate-950">
                    <div id="level-sc" class="text-[8px] text-center font-black h-3"></div>
                </div>
            </div>

            <button onclick="firstSearch()" id="btn-search" disabled class="w-full bg-blue-600 text-white font-black py-2 rounded-xl shadow-md transition-all text-sm active:scale-95 disabled:opacity-50">
                åŸ·è¡Œåˆ†æ
            </button>
        </div>
    </header>

    <main class="max-w-6xl mx-auto p-3 sm:p-5 flex-grow w-full">
        <section id="search-section" class="mb-5 p-4 bg-blue-50 border border-blue-100 rounded-2xl space-y-3 shadow-sm">
            <div class="flex items-center justify-between px-1">
                <h2 class="text-[10px] font-black text-blue-700 uppercase tracking-widest flex items-center gap-1.5">ğŸ’¡ é€²éšç¯©é¸å·¥å…·</h2>
                <div id="result-count" class="bg-blue-600 text-white px-2 py-0.5 rounded text-[9px] font-black">0 ç­†</div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-12 gap-2">
                <input type="text" id="keyword" oninput="runFilter()" placeholder="ğŸ” æœå°‹å¤§å­¸æˆ–ç§‘ç³»åç¨±..." class="md:col-span-4 bg-white border-none rounded-xl px-4 py-2.5 text-xs font-bold shadow-sm outline-none">
                <select id="regionFilter" onchange="runFilter()" class="md:col-span-3 bg-white border-none rounded-xl px-4 py-2.5 text-xs font-bold text-slate-600 outline-none shadow-sm">
                    <option value="ALL">ğŸ“ æ‰€æœ‰åœ°å€</option>
                    <option value="NORTH">åŒ—éƒ¨åœ°å€</option><option value="CENTRAL">ä¸­éƒ¨åœ°å€</option>
                    <option value="SOUTH">å—éƒ¨åœ°å€</option><option value="EAST">æ±éƒ¨åœ°å€</option><option value="ISLAND">é›¢å³¶åœ°å€</option>
                </select>
                <select id="typeFilter" onchange="runFilter()" class="md:col-span-2 bg-white border-none rounded-xl px-4 py-2.5 text-xs font-bold text-slate-600 outline-none shadow-sm">
                    <option value="ALL">ğŸ›ï¸ æ‰€æœ‰å­¸æ ¡</option>
                    <option value="PUBLIC">åœ‹ç«‹</option><option value="PRIVATE">ç§ç«‹</option>
                </select>
                <select id="groupFilter" onchange="runFilter()" class="md:col-span-3 bg-white border-none rounded-xl px-4 py-2.5 text-xs font-bold text-slate-600 outline-none shadow-sm">
                    <option value="ALL">ğŸ“ æ‰€æœ‰å­¸ç¾¤</option>
                </select>
            </div>
        </section>

        <div id="result-container" class="space-y-3 pb-10">
            <div class="py-24 text-center bg-white rounded-3xl border-2 border-dashed border-slate-200">
                <p class="text-slate-300 font-black text-sm">è«‹è¼¸å…¥åˆ†æ•¸ä¸¦é»æ“Šã€ŒåŸ·è¡Œåˆ†æã€</p>
            </div>
        </div>
    </main>

    <footer class="text-center py-8 text-slate-400 text-[10px] font-bold tracking-widest border-t border-slate-100 bg-white/50">
        æ¡ƒåœ’å¸‚ç«‹è§€éŸ³é«˜ä¸­ æ—ä»Ÿå¼˜è€å¸«è£½ä½œ
    </footer>

    <script>
        let db = [];
        const stdMap = { 'åœ‹æ–‡': [13,12,10,9,7], 'è‹±æ–‡': [13,11,8,5,3], 'æ•¸å­¸A': [12,10,8,5,4], 'æ•¸å­¸B': [11,9,5,3,2], 'ç¤¾æœƒ': [13,12,10,8,7], 'è‡ªç„¶': [13,12,9,7,5] };
        const regionMapping = { 'NORTH': ["åœ‹ç«‹è‡ºç£å¤§å­¸", "åœ‹ç«‹è‡ºç£å¸«ç¯„å¤§å­¸", "æ±å³å¤§å­¸", "åœ‹ç«‹æ”¿æ²»å¤§å­¸", "ä¸­åŸå¤§å­¸", "åœ‹ç«‹æ¸…è¯å¤§å­¸", "åœ‹ç«‹é™½æ˜äº¤é€šå¤§å­¸", "æ·¡æ±Ÿå¤§å­¸", "åœ‹ç«‹ä¸­å¤®å¤§å­¸", "ä¸­åœ‹æ–‡åŒ–å¤§å­¸", "å¤§åŒå¤§å­¸", "è¼”ä»å¤§å­¸", "åœ‹ç«‹è‡ºç£æµ·æ´‹å¤§å­¸", "åœ‹ç«‹è‡ºåŒ—è—è¡“å¤§å­¸", "é•·åºšå¤§å­¸", "åœ‹ç«‹è‡ºåŒ—æ•™è‚²å¤§å­¸", "è‡ºåŒ—å¸‚ç«‹å¤§å­¸", "åœ‹ç«‹é«”è‚²å¤§å­¸", "å…ƒæ™ºå¤§å­¸", "ä¸­è¯å¤§å­¸", "è¯æ¢µå¤§å­¸", "éŠ˜å‚³å¤§å­¸", "ä¸–æ–°å¤§å­¸", "å¯¦è¸å¤§å­¸", "åœ‹ç«‹è‡ºç£è—è¡“å¤§å­¸", "ç„å¥˜å¤§å­¸", "çœŸç†å¤§å­¸", "åœ‹ç«‹è‡ºåŒ—å¤§å­¸", "è‡ºåŒ—é†«å­¸å¤§å­¸", "é–‹å—å¤§å­¸", "åº·å¯§å¤§å­¸", "é¦¬å•é†«å­¸é™¢"], 'CENTRAL': ["åœ‹ç«‹ä¸­èˆˆå¤§å­¸", "æ±æµ·å¤§å­¸", "ä¸­åœ‹é†«è—¥å¤§å­¸", "é€¢ç”²å¤§å­¸", "éœå®œå¤§å­¸", "åœ‹ç«‹å½°åŒ–å¸«ç¯„å¤§å­¸", "ä¸­å±±é†«å­¸å¤§å­¸", "åœ‹ç«‹è‡ºä¸­æ•™è‚²å¤§å­¸", "å¤§è‘‰å¤§å­¸", "åœ‹ç«‹æš¨å—åœ‹éš›å¤§å­¸", "åœ‹ç«‹è‡ºç£é«”è‚²é‹å‹•å¤§å­¸", "äºæ´²å¤§å­¸", "åœ‹ç«‹è¯åˆå¤§å­¸"], 'SOUTH': ["åœ‹ç«‹æˆåŠŸå¤§å­¸", "é«˜é›„é†«å­¸å¤§å­¸", "åœ‹ç«‹é«˜é›„å¸«ç¯„å¤§å­¸", "åœ‹ç«‹ä¸­å±±å¤§å­¸", "åœ‹ç«‹è‡ºå—å¤§å­¸", "åœ‹ç«‹å±æ±å¤§å­¸", "åœ‹ç«‹ä¸­æ­£å¤§å­¸", "ç¾©å®ˆå¤§å­¸", "é•·æ¦®å¤§å­¸", "å—è¯å¤§å­¸", "åœ‹ç«‹è‡ºå—è—è¡“å¤§å­¸", "åœ‹ç«‹å˜‰ç¾©å¤§å­¸", "åœ‹ç«‹é«˜é›„å¤§å­¸", "ä¸­ä¿¡é‡‘èç®¡ç†å­¸é™¢"], 'EAST': ["åœ‹ç«‹æ±è¯å¤§å­¸", "åœ‹ç«‹è‡ºæ±å¤§å­¸", "æ…ˆæ¿Ÿå¤§å­¸", "ä½›å…‰å¤§å­¸", "åœ‹ç«‹å®œè˜­å¤§å­¸"], 'ISLAND': ["åœ‹ç«‹é‡‘é–€å¤§å­¸"] };

        async function init() {
            try {
                const res = await fetch('apply_data.json');
                db = await res.json();
                const groups = [...new Set(db.map(i => i['å­¸ç¾¤']))].filter(x => x);
                const gFilter = document.getElementById('groupFilter');
                groups.forEach(g => {
                    const opt = document.createElement('option');
                    opt.value = g; opt.innerText = g; gFilter.appendChild(opt);
                });
                document.getElementById('btn-search').disabled = false;
                document.getElementById('btn-search').innerText = "ç«‹å³åŸ·è¡Œåˆ†æ";
            } catch (e) { console.error(e); }
        }

        function updateLevels() {
            ['ch','en','ma','mb','so','sc'].forEach(id => {
                const sub = id==='ch'?'åœ‹æ–‡':id==='en'?'è‹±æ–‡':id==='ma'?'æ•¸å­¸A':id==='mb'?'æ•¸å­¸B':id==='so'?'ç¤¾æœƒ':'è‡ªç„¶';
                const val = parseInt(document.getElementById(id).value);
                const info = document.getElementById('level-'+id);
                if(!val && val !== 0) { info.innerText = ""; return; }
                const arr = stdMap[sub];
                let lv = "æœªé”", color = "text-slate-300";
                if(val >= arr[0]) { lv="é ‚"; color="text-red-700"; }
                else if(val >= arr[1]) { lv="å‰"; color="text-orange-600"; }
                else if(val >= arr[2]) { lv="å‡"; color="text-blue-700"; }
                else if(val >= arr[3]) { lv="å¾Œ"; color="text-slate-500"; }
                else if(val >= arr[4]) { lv="åº•"; color="text-amber-900"; }
                info.innerText = lv; info.className = `text-[8px] text-center font-black h-3 ${color}`;
            });
        }

        function firstSearch() {
            alert("ã€æº«é¦¨æé†’ã€‘\n\næœ¬ç³»çµ±åƒ…ä¾›åƒè€ƒã€‚ç”³è«‹å…¥å­¸æ¶‰åŠã€Œç¯©é¸å€ç‡ã€èˆ‡ã€ŒäºŒéšæŒ‡å®šé …ç›®ã€ï¼Œå‹™å¿…è©³é–±ç°¡ç« ã€‚ç¥ç¦é‡‘æ¦œé¡Œåï¼");
            document.getElementById('search-section').style.display = 'block';
            runFilter();
            window.scrollTo({ top: document.getElementById('search-section').offsetTop - 120, behavior: 'smooth' });
        }

        function renderWeights(i) {
            const res = [];
            ['åœ‹æ–‡','è‹±æ–‡','æ•¸å­¸A','æ•¸å­¸B','ç¤¾æœƒ','è‡ªç„¶'].forEach(s => {
                const w = i[s+'æ¯”é‡'] || 0;
                if(w > 0) res.push(`<span class="text-blue-600 font-black">${s[0]}:${w}%</span>`);
            });
            return res.length > 0 ? res.join(' ') : '--';
        }

        function renderMultipliers(i) {
            const res = [];
            ['åœ‹æ–‡','è‹±æ–‡','æ•¸å­¸A','æ•¸å­¸B','ç¤¾æœƒ','è‡ªç„¶'].forEach(s => {
                const m = i[s+'å€ç‡'];
                if(m && m != 0) res.push(`<span class="bg-blue-50 text-blue-500 px-1 rounded">${s[0]}:${m}</span>`);
            });
            return res.length > 0 ? res.join(' ') : 'ç„¡';
        }

        function runFilter() {
            const u = { 'åœ‹æ–‡': getPt('åœ‹æ–‡', parseInt(document.getElementById('ch').value || 0)), 'è‹±æ–‡': getPt('è‹±æ–‡', parseInt(document.getElementById('en').value || 0)), 'æ•¸å­¸A': getPt('æ•¸å­¸A', parseInt(document.getElementById('ma').value || 0)), 'æ•¸å­¸B': getPt('æ•¸å­¸B', parseInt(document.getElementById('mb').value || 0)), 'ç¤¾æœƒ': getPt('ç¤¾æœƒ', parseInt(document.getElementById('so').value || 0)), 'è‡ªç„¶': getPt('è‡ªç„¶', parseInt(document.getElementById('sc').value || 0)) };
            const grp = document.getElementById('groupFilter').value;
            const reg = document.getElementById('regionFilter').value;
            const typ = document.getElementById('typeFilter').value;
            const key = document.getElementById('keyword').value.toLowerCase();

            const res = db.filter(i => {
                const sch = i['å­¸æ ¡åç¨±'], dep = i['å­¸ç³»åç¨±'];
                if(grp !== 'ALL' && i['å­¸ç¾¤'] !== grp) return false;
                if(key && !(sch+dep).toLowerCase().includes(key)) return false;
                if(typ === 'PUBLIC' && !sch.includes("åœ‹ç«‹")) return false;
                if(typ === 'PRIVATE' && sch.includes("åœ‹ç«‹")) return false;
                if(reg !== 'ALL') { if(!regionMapping[reg].some(s => sch.startsWith(s))) return false; }
                return (i['åœ‹æ–‡æª¢å®šé»æ•¸']||0) <= u['åœ‹æ–‡'] && (i['è‹±æ–‡æª¢å®šé»æ•¸']||0) <= u['è‹±æ–‡'] && (i['æ•¸å­¸Aæª¢å®šé»æ•¸']||0) <= u['æ•¸å­¸A'] && (i['æ•¸å­¸Bæª¢å®šé»æ•¸']||0) <= u['æ•¸å­¸B'] && (i['ç¤¾æœƒæª¢å®šé»æ•¸']||0) <= u['ç¤¾æœƒ'] && (i['è‡ªç„¶æª¢å®šé»æ•¸']||0) <= u['è‡ªç„¶'];
            });

            document.getElementById('result-count').innerText = `${res.length} ç­†`;
            const container = document.getElementById('result-container');
            if(res.length === 0) { container.innerHTML = `<div class="py-20 text-center bg-white rounded-3xl border-2 border-dashed">æŸ¥ç„¡çµæœ</div>`; return; }

            container.innerHTML = res.map(i => `
                <div class="bg-white rounded-[2rem] border border-slate-200 p-5 shadow-sm hover:shadow-xl transition-all">
                    <div class="flex flex-col md:flex-row justify-between gap-3 mb-4">
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="bg-slate-950 text-white text-[8px] font-black px-1.5 py-0.5 rounded">${i['å­¸ç¾¤']}</span>
                                <a href="${i['æ ¡ç³»åˆ†å‰‡ç¶²å€']}" target="_blank" class="text-blue-700 text-[10px] font-black hover:underline">åˆ†å‰‡ â†—</a>
                            </div>
                            <h3 class="text-lg font-black text-slate-900 leading-tight">${i['å­¸æ ¡åç¨±']} ${i['å­¸ç³»åç¨±']}</h3>
                        </div>
                        <div class="flex items-center gap-1.5 bg-slate-50 px-2 py-2 rounded-xl border border-slate-100">
                            ${['åœ‹æ–‡','è‹±æ–‡','æ•¸å­¸A','æ•¸å­¸B','ç¤¾æœƒ','è‡ªç„¶'].map(s => {
                                const t = i[s+'æª¢å®š'];
                                return `<div class="flex flex-col items-center gap-0.5"><span class="text-[7px] font-black text-slate-300 uppercase">${s.replace('æ•¸å­¸','æ•¸')}</span><span class="std-tag ${t && t !== '--' ? 'tag-'+t : 'tag-ä¸æ¡è¨ˆ'}">${t || '--'}</span></div>`;
                            }).join('')}
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <div class="text-[11px] font-bold text-slate-700">
                                <span class="text-slate-400">æ‹›æ”¶äººæ•¸:</span> <b class="text-slate-900">${i['æ‹›ç”Ÿåé¡'] || '--'}äºº</b>
                                <span class="ml-4 text-slate-400">ç¯©é¸å€ç‡:</span> ${renderMultipliers(i)}
                            </div>
                            <div class="text-[11px] font-bold text-slate-700">
                                <span class="text-slate-400">äºŒéšæ¡è¨ˆ:</span> ${renderWeights(i)}
                            </div>
                            <div class="bg-slate-50 p-3 rounded-xl text-[10px] font-bold text-slate-500 leading-relaxed">
                                <div class="text-blue-700 font-black mb-1 underline">ç¯©é¸é †åºèˆ‡æ—¥ç¨‹</div>
                                <div>114é †åº: ${i['114å¹´ç¯©é¸é †åºä¸€'] ? i['114å¹´ç¯©é¸é †åºä¸€']+' â†’ ...' : '--'}</div>
                                <div class="mt-1">æ”¶ä»¶æˆªæ­¢: <span class="text-slate-800">${i['å¯©æŸ¥è³‡æ–™æ”¶ä»¶æˆªæ­¢æ—¥'] || '--'}</span></div>
                                <div>ç”„è©¦æ—¥æœŸ: <span class="text-slate-800">${i['ç”„è©¦æ—¥æœŸèµ·'] || '--'} ~ ${i['ç”„è©¦æ—¥æœŸè¿„'] || '--'}</span></div>
                            </div>
                        </div>
                        <div class="flex flex-wrap gap-2 items-end justify-end">
                            <a href="${i['114å¹´éŒ„å–æ¨™æº–é€£çµ']}" target="_blank" class="bg-slate-100 text-slate-600 px-4 py-2 rounded-xl text-[9px] font-black border border-slate-200">114 éŒ„å– â†—</a>
                            <a href="${i['113å¹´éŒ„å–æ¨™æº–é€£çµ']}" target="_blank" class="bg-slate-100 text-slate-600 px-4 py-2 rounded-xl text-[9px] font-black border border-slate-200">113 éŒ„å– â†—</a>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        function getPt(sub, score) { const arr = stdMap[sub]; for(let i=0; i<5; i++) if(score >= arr[i]) return 5-i; return 0; }
        window.onload = init;
    </script>
</body>
</html>
