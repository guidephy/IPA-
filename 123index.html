<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>115å¹´å¤§å­¸ç”³è«‹å…¥å­¸è½é»å»ºè­°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; color: #0f172a; }
        .std-tag { padding: 1px 0; border-radius: 4px; font-size: 10px; font-weight: 900; text-align: center; display: block; width: 34px; }
        .tag-é ‚æ¨™ { background: #fee2e2; color: #991b1b; border: 1px solid #fecaca; }
        .tag-å‰æ¨™ { background: #ffedd5; color: #9a3412; border: 1px solid #fed7aa; }
        .tag-å‡æ¨™ { background: #dbeafe; color: #1e40af; border: 1px solid #bfdbfe; }
        .tag-å¾Œæ¨™ { background: #f1f5f9; color: #334155; border: 1px solid #e2e8f0; }
        .tag-ä¸æ¡è¨ˆ { background: #f8fafc; color: #cbd5e1; border: 1px solid #f1f5f9; }
        .score-input { border: 1.5px solid #e2e8f0; transition: all 0.2s; }
        .score-input:focus { border-color: #2563eb; background: #fff; outline: none; }
        .input-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
        @media (min-width: 1024px) { .input-grid { grid-template-columns: repeat(6, 1fr); gap: 12px; } }
        #search-section { display: none; }
    </style>
</head>
<body class="antialiased flex flex-col min-h-screen">

    <header class="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-6xl mx-auto p-4 sm:p-5">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-2">
                    <span class="text-xl">ğŸ“‹</span>
                    <h1 class="text-base sm:text-lg font-black text-slate-950 tracking-tighter">115 å¹´ç”³è«‹å…¥å­¸è½é»å»ºè­°</h1>
                </div>
                <div id="data-status" class="text-[8px] font-black text-slate-400 bg-slate-50 px-2 py-0.5 rounded border border-slate-100 uppercase">Ready</div>
            </div>
            
            <div class="input-grid mb-4">
                <div>
                    <label class="text-[9px] font-black text-slate-400 block text-center mb-0.5">åœ‹æ–‡</label>
                    <input type="number" id="ch" oninput="updateLevels()" placeholder="åˆ†æ•¸" class="score-input w-full bg-slate-50 rounded-lg py-2 text-center font-black text-slate-950">
                    <div id="level-ch" class="text-[8px] text-center font-black h-3"></div>
                </div>
                <div>
                    <label class="text-[9px] font-black text-slate-400 block text-center mb-0.5">è‹±æ–‡</label>
                    <input type="number" id="en" oninput="updateLevels()" placeholder="åˆ†æ•¸" class="score-input w-full bg-slate-50 rounded-xl py-2 text-center font-black text-slate-950">
                    <div id="level-en" class="text-[8px] text-center font-black h-3"></div>
                </div>
                <div>
                    <label class="text-[9px] font-black text-blue-500 block text-center mb-0.5">æ•¸A</label>
                    <input type="number" id="ma" oninput="updateLevels()" placeholder="åˆ†æ•¸" class="score-input w-full bg-slate-50 rounded-xl py-2 text-center font-black text-slate-950">
                    <div id="level-ma" class="text-[8px] text-center font-black h-3"></div>
                </div>
                <div>
                    <label class="text-[9px] font-black text-emerald-500 block text-center mb-0.5">æ•¸B</label>
                    <input type="number" id="mb" oninput="updateLevels()" placeholder="åˆ†æ•¸" class="score-input w-full bg-slate-50 rounded-xl py-2 text-center font-black text-slate-950">
                    <div id="level-mb" class="text-[8px] text-center font-black h-3"></div>
                </div>
                <div>
                    <label class="text-[9px] font-black text-slate-400 block text-center mb-0.5">ç¤¾æœƒ</label>
                    <input type="number" id="so" oninput="updateLevels()" placeholder="åˆ†æ•¸" class="score-input w-full bg-slate-50 rounded-xl py-2 text-center font-black text-slate-950">
                    <div id="level-so" class="text-[8px] text-center font-black h-3"></div>
                </div>
                <div>
                    <label class="text-[9px] font-black text-slate-400 block text-center mb-0.5">è‡ªç„¶</label>
                    <input type="number" id="sc" oninput="updateLevels()" placeholder="åˆ†æ•¸" class="score-input w-full bg-slate-50 rounded-xl py-2 text-center font-black text-slate-950">
                    <div id="level-sc" class="text-[8px] text-center font-black h-3"></div>
                </div>
            </div>

            <button onclick="firstSearch()" id="btn-search" disabled class="w-full bg-blue-600 text-white font-black py-3 rounded-xl shadow-md transition-all text-sm active:scale-95">
                ç«‹å³åˆ†æç”³è«‹å…¥å­¸
            </button>
        </div>
    </header>

    <main class="max-w-6xl mx-auto p-4 sm:p-5 flex-grow w-full">
        <section id="search-section" class="mb-5 p-5 bg-blue-50/50 border border-blue-100 rounded-2xl space-y-4 shadow-sm">
            <div class="flex items-center justify-between px-1">
                <h2 class="text-[10px] font-black text-blue-700 uppercase tracking-widest flex items-center gap-2">ğŸ’¡ é€²éšç¯©é¸å·¥å…·</h2>
                <div id="result-count" class="bg-blue-600 text-white px-3 py-1 rounded text-[9px] font-black">0 ç­†ç¬¦åˆ</div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-12 gap-3">
                <input type="text" id="keyword" oninput="runFilter()" placeholder="ğŸ” æœå°‹å¤§å­¸æˆ–ç§‘ç³»åç¨±..." class="md:col-span-4 bg-white border-none rounded-xl px-5 py-3 text-xs font-bold shadow-sm outline-none">
                <select id="regionFilter" onchange="runFilter()" class="md:col-span-3 bg-white border-none rounded-xl px-5 py-3 text-xs font-bold text-slate-600 outline-none shadow-sm">
                    <option value="ALL">ğŸ“ æ‰€æœ‰åœ°å€</option>
                    <option value="NORTH">åŒ—éƒ¨</option><option value="CENTRAL">ä¸­éƒ¨</option><option value="SOUTH">å—éƒ¨</option><option value="EAST">æ±éƒ¨</option><option value="ISLAND">é›¢å³¶</option>
                </select>
                <select id="typeFilter" onchange="runFilter()" class="md:col-span-2 bg-white border-none rounded-xl px-5 py-3 text-xs font-bold text-slate-600 outline-none shadow-sm">
                    <option value="ALL">ğŸ›ï¸ æ‰€æœ‰å­¸æ ¡</option>
                    <option value="PUBLIC">åœ‹ç«‹</option><option value="PRIVATE">ç§ç«‹</option>
                </select>
                <select id="groupFilter" onchange="runFilter()" class="md:col-span-3 bg-slate-900 text-white rounded-xl px-5 py-3 text-xs font-black outline-none shadow-lg">
                    <option value="ALL">ğŸ“ æ‰€æœ‰å­¸ç¾¤</option>
                </select>
            </div>
        </section>

        <div id="result-container" class="space-y-4 pb-10">
            <div class="py-24 text-center bg-white rounded-3xl border-2 border-dashed border-slate-200 text-slate-300 font-black">
                è«‹è¼¸å…¥åˆ†æ•¸ä¸¦é»æ“Šã€Œç«‹å³åˆ†æã€
            </div>
        </div>
    </main>

    <footer class="text-center py-8 text-slate-400 text-[10px] font-bold tracking-widest border-t border-slate-100 bg-white/50 mt-10">
        æ¡ƒåœ’å¸‚ç«‹è§€éŸ³é«˜ä¸­ æ—ä»Ÿå¼˜è€å¸«è£½ä½œ
    </footer>

    <script>
        let db = [];
        const stdMap = { 'åœ‹æ–‡': [13,12,10,9,7], 'è‹±æ–‡': [13,11,8,5,3], 'æ•¸å­¸A': [12,10,8,5,4], 'æ•¸å­¸B': [11,9,5,3,2], 'ç¤¾æœƒ': [13,12,10,8,7], 'è‡ªç„¶': [13,12,9,7,5] };
        
        const regionMapping = {
            'NORTH': ["åœ‹ç«‹è‡ºç£å¤§å­¸", "åœ‹ç«‹è‡ºç£å¸«ç¯„å¤§å­¸", "æ±å³å¤§å­¸", "åœ‹ç«‹æ”¿æ²»å¤§å­¸", "ä¸­åŸå¤§å­¸", "åœ‹ç«‹æ¸…è¯å¤§å­¸", "åœ‹ç«‹é™½æ˜äº¤é€šå¤§å­¸", "æ·¡æ±Ÿå¤§å­¸", "åœ‹ç«‹ä¸­å¤®å¤§å­¸", "ä¸­åœ‹æ–‡åŒ–å¤§å­¸", "å¤§åŒå¤§å­¸", "è¼”ä»å¤§å­¸", "åœ‹ç«‹è‡ºç£æµ·æ´‹å¤§å­¸", "åœ‹ç«‹è‡ºåŒ—è—è¡“å¤§å­¸", "é•·åºšå¤§å­¸", "åœ‹ç«‹è‡ºåŒ—æ•™è‚²å¤§å­¸", "è‡ºåŒ—å¸‚ç«‹å¤§å­¸", "åœ‹ç«‹é«”è‚²å¤§å­¸", "å…ƒæ™ºå¤§å­¸", "ä¸­è¯å¤§å­¸", "è¯æ¢µå¤§å­¸", "éŠ˜å‚³å¤§å­¸", "ä¸–æ–°å¤§å­¸", "å¯¦è¸å¤§å­¸", "åœ‹ç«‹è‡ºç£è—è¡“å¤§å­¸", "ç„å¥˜å¤§å­¸", "çœŸç†å¤§å­¸", "åœ‹ç«‹è‡ºåŒ—å¤§å­¸", "è‡ºåŒ—é†«å­¸å¤§å­¸", "é–‹å—å¤§å­¸", "åº·å¯§å¤§å­¸", "é¦¬å•é†«å­¸é™¢"],
            'CENTRAL': ["åœ‹ç«‹ä¸­èˆˆå¤§å­¸", "æ±æµ·å¤§å­¸", "ä¸­åœ‹é†«è—¥å¤§å­¸", "é€¢ç”²å¤§å­¸", "éœå®œå¤§å­¸", "åœ‹ç«‹å½°åŒ–å¸«ç¯„å¤§å­¸", "ä¸­å±±é†«å­¸å¤§å­¸", "åœ‹ç«‹è‡ºä¸­æ•™è‚²å¤§å­¸", "å¤§è‘‰å¤§å­¸", "åœ‹ç«‹æš¨å—åœ‹éš›å¤§å­¸", "åœ‹ç«‹è‡ºç£é«”è‚²é‹å‹•å¤§å­¸", "äºæ´²å¤§å­¸", "åœ‹ç«‹è¯åˆå¤§å­¸"],
            'SOUTH': ["åœ‹ç«‹æˆåŠŸå¤§å­¸", "é«˜é›„é†«å­¸å¤§å­¸", "åœ‹ç«‹é«˜é›„å¸«ç¯„å¤§å­¸", "åœ‹ç«‹ä¸­å±±å¤§å­¸", "åœ‹ç«‹è‡ºå—å¤§å­¸", "åœ‹ç«‹å±æ±å¤§å­¸", "åœ‹ç«‹ä¸­æ­£å¤§å­¸", "ç¾©å®ˆå¤§å­¸", "é•·æ¦®å¤§å­¸", "å—è¯å¤§å­¸", "åœ‹ç«‹è‡ºå—è—è¡“å¤§å­¸", "åœ‹ç«‹å˜‰ç¾©å¤§å­¸", "åœ‹ç«‹é«˜é›„å¤§å­¸", "ä¸­ä¿¡é‡‘èç®¡ç†å­¸é™¢"],
            'EAST': ["åœ‹ç«‹æ±è¯å¤§å­¸", "åœ‹ç«‹è‡ºæ±å¤§å­¸", "æ…ˆæ¿Ÿå¤§å­¸", "ä½›å…‰å¤§å­¸", "åœ‹ç«‹å®œè˜­å¤§å­¸"],
            'ISLAND': ["åœ‹ç«‹é‡‘é–€å¤§å­¸"]
        };

        async function init() {
            try {
                const res = await fetch('apply_data.json');
                db = await res.json();
                
                // å‹•æ…‹ç”¢ç”Ÿå­¸ç¾¤é¸å–®
                const groups = [...new Set(db.map(i => i['å­¸ç¾¤']))].filter(x => x);
                const gFilter = document.getElementById('groupFilter');
                groups.forEach(g => {
                    const opt = document.createElement('option');
                    opt.value = g; opt.innerText = g;
                    gFilter.appendChild(opt);
                });

                document.getElementById('btn-search').disabled = false;
                document.getElementById('data-status').innerText = "DB Connected";
            } catch (e) { console.error(e); }
        }

        function updateLevels() {
            ['ch','en','ma','mb','so','sc'].forEach(id => {
                const sub = id==='ch'?'åœ‹æ–‡':id==='en'?'è‹±æ–‡':id==='ma'?'æ•¸å­¸A':id==='mb'?'æ•¸å­¸B':id==='so'?'ç¤¾æœƒ':'è‡ªç„¶';
                const val = parseInt(document.getElementById(id).value);
                const info = document.getElementById('level-'+id);
                if(!val && val !== 0) { info.innerText = ""; return; }
                const arr = stdMap[sub];
                let lv = "æœªé”", color = "text-slate-300";
                if(val >= arr[0]) { lv="é ‚"; color="text-red-700"; }
                else if(val >= arr[1]) { lv="å‰"; color="text-orange-600"; }
                else if(val >= arr[2]) { lv="å‡"; color="text-blue-700"; }
                else if(val >= arr[3]) { lv="å¾Œ"; color="text-slate-500"; }
                else if(val >= arr[4]) { lv="åº•"; color="text-amber-900"; }
                info.innerText = lv; info.className = `text-[8px] text-center font-black h-3 ${color}`;
            });
        }

        function firstSearch() {
            const message = "ã€ç”³è«‹å…¥å­¸æº«é¦¨æé†’ã€‘\n\næœ¬ç³»çµ±ä¹‹ç¯©é¸çµæœåƒ…ä¾›åˆæ­¥åƒè€ƒã€‚ç”³è«‹å…¥å­¸æ¶‰åŠã€Œå€ç‡ç¯©é¸ã€èˆ‡ã€Œç¬¬äºŒéšæ®µæŒ‡å®šé …ç›®ç”„è©¦ã€ï¼Œéç¨‹æ›´ç‚ºè¤‡é›œã€‚\n\nå»ºè­°æ‚¨é™¤äº†åƒè€ƒæœ¬ç³»çµ±å¤–ï¼Œå‹™å¿…è©³é–±ç°¡ç« åˆ†å‰‡ã€ä¸¦èˆ‡è€å¸«ã€å®¶é•·å……åˆ†è¨è«–ã€‚\n\nç¥ç¦æ‚¨é¸ç³»é †åˆ©ï¼Œé‡‘æ¦œé¡Œåï¼";
            alert(message);
            document.getElementById('search-section').style.display = 'block';
            runFilter();
            window.scrollTo({ top: document.getElementById('search-section').offsetTop - 150, behavior: 'smooth' });
        }

        function getPt(sub, score) { const arr = stdMap[sub]; for(let i=0; i<5; i++) if(score >= arr[i]) return 5-i; return 0; }

        function renderThresholds(i) {
            return ['åœ‹æ–‡','è‹±æ–‡','æ•¸å­¸A','æ•¸å­¸B','ç¤¾æœƒ','è‡ªç„¶'].map(s => {
                const t = i[s+'æª¢å®š'];
                return `<div class="flex flex-col items-center gap-0.5">
                            <span class="text-[7px] font-black text-slate-300">${s.replace('æ•¸å­¸','æ•¸')}</span>
                            <span class="std-tag ${t && t !== '--' ? 'tag-'+t : 'tag-ä¸æ¡è¨ˆ'}">${t || '--'}</span>
                        </div>`;
            }).join('');
        }

        function renderMultipliers(i) {
            const res = [];
            ['åœ‹æ–‡','è‹±æ–‡','æ•¸å­¸A','æ•¸å­¸B','ç¤¾æœƒ','è‡ªç„¶'].forEach(s => {
                const m = i[s+'å€ç‡'];
                if(m && m != 0) res.push(`<span class="bg-blue-50 text-blue-600 px-1.5 py-0.5 rounded border border-blue-100">${s[0]}:${m}</span>`);
            });
            return res.join(' ');
        }

        function renderOrder(i, yr) {
            const orders = [];
            for(let j=1; j<=6; j++) {
                const step = i[`${yr}å¹´ç¯©é¸é †åº` + (["ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"][j-1])];
                if(step) orders.push(step);
            }
            if(orders.length === 0) return `<div class="text-[10px] text-slate-300">è©²å¹´ç„¡ç¯©é¸é †åºè³‡æ–™</div>`;
            return `<div class="text-[10px] font-bold text-slate-600 leading-relaxed"><span class="text-slate-400 mr-2">${yr}é †åº:</span>${orders.join(' â†’ ')}</div>`;
        }

        function runFilter() {
            const u = {
                'åœ‹æ–‡': getPt('åœ‹æ–‡', parseInt(document.getElementById('ch').value || 0)),
                'è‹±æ–‡': getPt('è‹±æ–‡', parseInt(document.getElementById('en').value || 0)),
                'æ•¸å­¸A': getPt('æ•¸å­¸A', parseInt(document.getElementById('ma').value || 0)),
                'æ•¸å­¸B': getPt('æ•¸å­¸B', parseInt(document.getElementById('mb').value || 0)),
                'ç¤¾æœƒ': getPt('ç¤¾æœƒ', parseInt(document.getElementById('so').value || 0)),
                'è‡ªç„¶': getPt('è‡ªç„¶', parseInt(document.getElementById('sc').value || 0))
            };
            const grp = document.getElementById('groupFilter').value;
            const reg = document.getElementById('regionFilter').value;
            const typ = document.getElementById('typeFilter').value;
            const key = document.getElementById('keyword').value.toLowerCase();

            const res = db.filter(i => {
                const school = i['å­¸æ ¡åç¨±'];
                const dept = i['å­¸ç³»åç¨±'];
                if(grp !== 'ALL' && i['å­¸ç¾¤'] !== grp) return false;
                if(key && !(school+dept).toLowerCase().includes(key)) return false;
                if(typ === 'PUBLIC' && !school.includes("åœ‹ç«‹")) return false;
                if(typ === 'PRIVATE' && school.includes("åœ‹ç«‹")) return false;
                if(reg !== 'ALL') {
                    const matchRegion = regionMapping[reg].some(s => school.startsWith(s));
                    if(!matchRegion) return false;
                }
                return (i['åœ‹æ–‡æª¢å®šé»æ•¸']||0) <= u['åœ‹æ–‡'] && (i['è‹±æ–‡æª¢å®šé»æ•¸']||0) <= u['è‹±æ–‡'] && 
                       (i['æ•¸å­¸Aæª¢å®šé»æ•¸']||0) <= u['æ•¸å­¸A'] && (i['æ•¸å­¸Bæª¢å®šé»æ•¸']||0) <= u['æ•¸å­¸B'] && 
                       (i['ç¤¾æœƒæª¢å®šé»æ•¸']||0) <= u['ç¤¾æœƒ'] && (i['è‡ªç„¶æª¢å®šé»æ•¸']||0) <= u['è‡ªç„¶'];
            });

            document.getElementById('result-count').innerText = `${res.length} ç­†`;
            const container = document.getElementById('result-container');
            if(res.length === 0) {
                container.innerHTML = `<div class="py-20 text-center text-slate-400 font-bold bg-white rounded-3xl border-2 border-dashed">æŸ¥ç„¡ç¬¦åˆæª¢å®šä¹‹æ ¡ç³»</div>`;
                return;
            }

            container.innerHTML = res.map(i => `
                <div class="bg-white rounded-[2rem] border border-slate-200 p-5 md:p-6 shadow-sm hover:shadow-xl transition-all">
                    <div class="flex flex-col md:flex-row justify-between gap-4 mb-4">
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-1.5">
                                <span class="bg-slate-900 text-white text-[9px] font-black px-2 py-0.5 rounded">${i['å­¸ç¾¤']}</span>
                                <span class="text-slate-300 text-[10px] font-bold">Code: ${i['å­¸ç³»ä»£ç¢¼']}</span>
                            </div>
                            <h3 class="text-lg font-black text-slate-900 leading-tight">${i['å­¸æ ¡åç¨±']} ${i['å­¸ç³»åç¨±']}</h3>
                        </div>
                        <div class="flex items-center gap-1.5 bg-slate-50 px-3 py-2 rounded-xl border border-slate-100">
                            ${renderThresholds(i)}
                        </div>
                    </div>

                    <div class="space-y-3">
                        <div class="flex flex-wrap items-center gap-2 text-[10px] font-black">
                            <span class="text-slate-400 uppercase">ç¯©é¸å€ç‡:</span>
                            ${renderMultipliers(i)}
                        </div>
                        <div class="bg-slate-50/50 p-3 rounded-xl space-y-2">
                            ${renderOrder(i, '114')}
                            ${renderOrder(i, '113')}
                        </div>
                        <div class="flex flex-wrap gap-2 pt-2">
                            <a href="${i['æ ¡ç³»åˆ†å‰‡ç¶²å€']}" target="_blank" class="bg-blue-600 text-white px-4 py-2 rounded-xl text-[10px] font-black shadow-md shadow-blue-100">ğŸ“„ æ ¡ç³»åˆ†å‰‡ â†—</a>
                            <a href="${i['114å¹´éŒ„å–æ¨™æº–é€£çµ']}" target="_blank" class="bg-slate-100 text-slate-600 px-4 py-2 rounded-xl text-[10px] font-black border border-slate-200">114 éŒ„å– â†—</a>
                            <a href="${i['113å¹´éŒ„å–æ¨™æº–é€£çµ']}" target="_blank" class="bg-slate-100 text-slate-600 px-4 py-2 rounded-xl text-[10px] font-black border border-slate-200">113 éŒ„å– â†—</a>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        window.onload = init;
    </script>
</body>
</html>